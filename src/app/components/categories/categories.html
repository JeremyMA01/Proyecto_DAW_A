<div class="encabezado">
    <h2>Gestión de Categorías</h2> 
    <button class="añadir" (click)="openNew()">Agregar Categoría</button>
</div>

<input type="text" class="busquedaInput" placeholder="Buscar categoría..." #busq (keyup)="search(busq)">

<div>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Id</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Estado</th>
            <th class="columnaButtonActions">Acciones</th>
        </tr>
    </thead>
    <tbody>
        @for(categorie of categories; track $index) {
            <tr>
                <td>{{categorie.id}}</td>
                <td>{{categorie.name}}</td>
                <td>{{categorie.description}}</td>
                <td>
                    @if(categorie.active) {
                        <span class="badge bg-success">Activa</span>
                    } @else {
                        <span class="badge bg-secondary">Inactiva</span>
                    }
                </td>
                <td class="buttonActions">
                    <button (click)="openEdit(categorie)" class="editar">
                        <i class="bi bi-pencil-square iconAction"></i>
                    </button>
                    <button (click)="delete(categorie)" class="eliminar">
                        <i class="bi bi-trash3-fill iconAction"></i>
                    </button>
                </td>
            </tr>
        }
        @empty {
            <tr>
                <td colspan="5" class="text-center">No hay categorías registradas</td>
            </tr>
        }
    </tbody>
</table>
</div>

<!-- MODAL -->
<div class="modal fade" id="categorieModal" tabindex="-1" #categorieModalRef>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          {{ editingId ? 'Editar Categoría' : 'Nueva Categoría' }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <form [formGroup]="formCategorie">
        <div class="modal-body">
          <!-- NOMBRE -->
          <div class="mb-3">
            <label class="form-label">Nombre *</label>
            <input type="text" class="form-control" formControlName="name" />
            @if(formCategorie.get('name')?.invalid && formCategorie.get('name')?.touched) {
              <small class="text-danger">El nombre es requerido y solo puede contener letras y espacios</small>
            }
          </div>

          <!-- DESCRIPCIÓN -->
          <div class="mb-3">
            <label class="form-label">Descripción *</label>
            <textarea class="form-control" formControlName="description" rows="3"></textarea>
            @if(formCategorie.get('description')?.invalid && formCategorie.get('description')?.touched) {
              <small class="text-danger">La descripción es requerida</small>
            }
          </div>

          <!-- ACTIVE CHECKBOX -->
          <div class="form-check mb-3">
            <input
              class="form-check-input"
              type="checkbox"
              formControlName="active"
              id="checkActive"
            />
            <label class="form-check-label" for="checkActive">Categoría Activa</label>
          </div>

        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" (click)="modalRef.hide()">
            Cancelar
          </button>
          <button class="btn btn-primary" type="button" (click)="save()">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>