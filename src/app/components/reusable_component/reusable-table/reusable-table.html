<div class="container-fluid mt-4">

  <div class="card shadow-sm border-0 rounded-3">
    <div class="card-body p-0">
      <div class="table-responsive">

        <table class="table table-hover align-middle mb-0">
          <thead class="bg-light">
            <tr>
              @for (col of columnas; track col.key) {
                <th class="px-4 py-3 text-secondary text-uppercase fw-bold" 
                    style="font-size: 0.82rem; letter-spacing: 0.5px;">
                  {{ col.label }}
                </th>
              }
              <th class="px-4 py-3 text-secondary text-uppercase fw-bold text-center" 
                  style="font-size: 0.82rem; letter-spacing: 0.5px;">
                Acciones
              </th>
            </tr>
          </thead>

          <tbody>
            @for (fila of pageActual(); track $index) {

              <tr class="table-row" (click)="onFilaClick(fila)" style="cursor: pointer">

                @for (col of columnas; track col.key) {

                  <td class="px-4 py-3">

                    @switch (col.key) {

                      @case ('isRecommend') {
                        <span class="badge rounded-pill"
                              [ngClass]="fila[col.key] 
                                ? 'bg-success-subtle text-success' 
                                : 'bg-danger-subtle text-danger'">
                          <i class="bi"
                             [ngClass]="fila[col.key] 
                                ? 'bi-hand-thumbs-up' 
                                : 'bi-hand-thumbs-down'"></i>
                          {{ fila[col.key] ? 'Sí' : 'No' }}
                        </span>
                      }
                        @case ('active') {   
                       <span class="badge rounded-pill"
                         [ngClass]="fila[col.key] 
                          ? 'bg-success-subtle text-success' 
                            : 'bg-danger-subtle text-danger'">
                        {{ fila[col.key] ? 'Activo' : 'Inactivo' }}
                         </span>
                       }

                      @default {
                        
                        @if (col.key === 'genre') {
                          <span class="text-dark">
                            {{ obtenerGeneroNombre(fila[col.key]) }}
                          </span>
                        } @else {
                          <span class="text-dark">{{ fila[col.key] }}</span>
                        }
                      }

                    }

                  </td>
                }

                <td class="px-4 py-3 text-center">
                  <div class="d-flex justify-content-center gap-1"
                       (click)="$event.stopPropagation()">

                    <button class="btn btn-icon btn-ghost-info" 
                    title="Ver"
                    (click)="Onview(fila, $event)">
                      <i class="bi bi-eye-fill"></i>
                    </button>

                    <button class="btn btn-icon btn-ghost-warning "
                            title="Editar" 
                            (click)="OnEditClick(fila)">
                      <i class="bi bi-pencil-fill"></i>
                    </button>

                    <button class="btn btn-icon btn-ghost-danger "
                            title="Eliminar"
                            (click)="onEliminarClick(fila)">
                      <i class="bi bi-trash3-fill"></i>
                    </button>

                    

                  </div>
                </td>

              </tr>

            } @empty {

              <tr>
                <td [attr.colspan]="columnas.length + 1"
                    class="text-center py-5 text-muted">
                  <i class="bi bi-inbox fs-2 d-block mb-2"></i>
                  No se encontraron registros.
                </td>
              </tr>

            }
          </tbody>
        </table>

      </div>
    </div>

    <div class="card-footer bg-white border-top-0 py-3">
      <nav class="d-flex justify-content-between align-items-center flex-wrap gap-2">

        <small class="text-muted fw-medium">
          Mostrando página {{page}} de {{totalPaginas()}}
        </small>

        <ul class="pagination pagination-sm mb-0 shadow-sm">
          <li class="page-item" [class.disabled]="page === 1">
            <button class="page-link" (click)="setPage(page - 1)">Anterior</button>
          </li>

          @for (p of [].constructor(totalPaginas()); track $index) {
            <li class="page-item" [class.active]="page === ($index + 1)">
              <button class="page-link" (click)="setPage($index + 1)">
                {{ $index + 1 }}
              </button>
            </li>
          }

          <li class="page-item" [class.disabled]="page === totalPaginas()">
            <button class="page-link" (click)="setPage(page + 1)">Siguiente</button>
          </li>
        </ul>

      </nav>
    </div>

  </div>
</div>

